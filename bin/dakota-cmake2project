#!/usr/bin/perl -w
# -*- mode: cperl -*-
# -*- cperl-close-paren-offset: -2 -*-
# -*- cperl-continued-statement-offset: 2 -*-
# -*- cperl-indent-level: 2 -*-
# -*- cperl-indent-parens-as-block: t -*-
# -*- cperl-tab-always-indent: t -*-

use strict;
use warnings;

my $nl = "\n";

undef $/;
my ($in_path, $out_path) = @ARGV;
open(my $in, '<', $in_path) || die 'ERROR: ' . $in_path . ": $!";
my $filestr = <$in>;
close($in);
$filestr =~ s/^set\s*\(\s*([^\s]+) */'$1' => \(/gsm;
$filestr =~ s/^(\s+)([^\s]+)$/$1'$2',/gsm;
$filestr =~ s/\(([^\s]+)\)$/('$1')/gsm;
$filestr =~ s/\(/[/gs;
$filestr =~ s/\)/],/gs;
$filestr = '{' . $nl . $filestr . '}' . $nl;
$filestr =~ s/\n([^{}])/\n  $1/gs;
open(my $out, '>', $out_path) || die 'ERROR: ' . $out_path . ": $!";
print $out $filestr;
close($out);
