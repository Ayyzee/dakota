#!/bin/bash
set -o nounset -o errexit -o pipefail -o verbose

rm --force config.mk
rm --force config.sh
rm --force src/config.hh
rm --force lib/dakota/compiler.json
rm --force lib/dakota/platform.json
rm --force lib/dakota/compiler-default-argument-promotions.json

if (( 0 == $# )); then
  exit
fi

sysname=$1
compiler=$2

ln --symbolic config-$sysname.mk config.mk
ln --symbolic config-$sysname.sh config.sh

pushd src > /dev/null 2>&1
ln --symbolic config-$sysname.hh config.hh
popd > /dev/null 2>&1

pushd lib/dakota > /dev/null 2>&1
ln --symbolic platform-$sysname.json  platform.json
ln --symbolic compiler-$compiler.json compiler.json
popd > /dev/null 2>&1

make --no-print-directory --directory src/port/compiler-default-argument-promotions install > /dev/null 2>&1
make --no-print-directory --directory src/port/compiler-default-argument-promotions clean
