// -*- mode: Dakota; c-basic-offset: 2; tab-width: 2; indent-tabs-mode: nil -*-

klass features; // hackhack

int-t main()
{
  int-t value = 0;

  try
  {
    object-t perl-object-output-stream = make(perl-object-output-stream::klass, file : stdout);
    object-t table =  make(hashed-table::klass);
    object-t vector =  make(vector::klass);
    object-t string1 = make(string::klass, bytes : "hello father");
    object-t string2 = make(string::klass, bytes : "hello mother");
    dk::add-last(vector, string1);
    dk::add-last(vector, vector);
    dk::add-last(vector, string2);
    dk::add-last(vector, null);
    dk::add(table, string2, vector);

    dk::write(perl-object-output-stream, table);
    dk::close(perl-object-output-stream);
  }
  catch(...)
  {
    fprintf(stderr, "ERROR: uncaught exception\n");
    value = 1;
  }

  return value;
}
