// -*- mode: Dakota; c-basic-offset: 2; tab-width: 2; indent-tabs-mode: nil -*-

klass json-parser;
klass xml-object-output-stream;
klass features;

klass k1
{
  superklass object;
  slots
  {
    int32-t value;
  }

  method object-t write-part(object-t self, object-t out)
  {
    $write-slots(super, out);
    $write-slots-start(out, klass);
    $write-element(out, self.value, "value");
    $write-slots-end(out);
    return self;
  }
}

klass k2
{
  superklass k1;
  slots
  {
    int32-t value;
  }
  method object-t write-slots(object-t self, object-t out)
  {
    $write-slots(super, out);
    $write-slots-start(out, klass);
    $write-element(out, self.value, "value");
    $write-slots-end(out);
    return self;
  }
}

klass k3
{
  superklass k2;
  slots
  {
    int32-t value;
  }
  method object-t write-slots(object-t self, object-t out)
  {
    $write-slots(super, out);
    $write-slots-start(out, klass);
    $write-element(out, self.value, "value");
    $write-slots-end(out);
    return self;
  }
}

int-t main()
{
  object-t parser = make(json-parser::klass);
  object-t property-list = $read-property-list(parser);

//   object-t i = make(k3::klass);
//   object-t ooutput-stream = make(json-object-output-stream::klass);
//   $write(ooutput-stream, i);

  object-t poutput-stream = make(xml-object-output-stream::klass);
  $write(poutput-stream, property-list);

  $close(poutput-stream);
  return 0;
}
